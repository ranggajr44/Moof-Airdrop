<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MOOF NETWORK | ELITE</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&display=swap');
        :root { --accent: #00f2ff; --bg: #000000; --card: #111111; }
        body { font-family: 'Space Grotesk', sans-serif; background: var(--bg); color: #ffffff; margin: 0; padding-bottom: 120px; overflow-x: hidden; -webkit-tap-highlight-color: transparent; }
        #bg-canvas { position: fixed; top: 0; left: 0; z-index: -1; width: 100%; height: 100%; opacity: 0.3; }
        .glass { background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.08); backdrop-filter: blur(12px); border-radius: 24px; transition: all 0.3s ease; }
        .btn-claim { background: #ffffff; color: #000000; font-weight: 700; transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 0 20px rgba(255, 255, 255, 0.2); }
        #loader { position: fixed; inset: 0; z-index: 10000; background: #000; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.5s; }
        .nav-active { color: var(--accent) !important; text-shadow: 0 0 10px var(--accent); }
        
        /* --- ANIMASI PELAN & SMOOTH --- */
        .tab-content { 
            transition: opacity 0.6s ease, transform 0.6s cubic-bezier(0.2, 0.8, 0.2, 1); 
        }
        .hidden { display: none !important; opacity: 0; transform: translateY(15px); }
        .fade-active { opacity: 1 !important; transform: translateY(0) !important; }

        .pump-tag { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
    </style>
</head>
<body>

    <canvas id="bg-canvas"></canvas>

    <div id="loader">
        <h1 class="loader-text font-bold tracking-[0.5em] mb-4">MOOFGUY</h1>
        <div class="w-48 h-[2px] bg-white/10 overflow-hidden rounded-full">
            <div id="load-progress" class="h-full bg-cyan-500 w-0 transition-all duration-300"></div>
        </div>
    </div>

    <header class="p-6 flex justify-between items-center sticky top-0 z-50 glass m-4 rounded-2xl border-white/5">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-white/5 border border-white/10 rounded-xl flex items-center justify-center font-bold text-xl">M</div>
            <span class="font-bold tracking-widest text-sm">MOOFGUY</span>
        </div>
        <button id="wallet-btn" onclick="connectWallet()" class="px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-[10px] font-bold uppercase tracking-wider">
            Connect Wallet
        </button>
    </header>

    <main class="p-4 max-w-md mx-auto">
        <section id="tab-home" class="tab-content fade-active space-y-8">
            <div class="text-center py-10">
                <div class="pump-tag text-[9px] text-cyan-400 font-bold tracking-widest mb-2 uppercase">‚óè Network Online</div>
                <p class="text-[10px] opacity-40 font-bold tracking-[0.2em] uppercase">Total Balance</p>
                <h2 id="balance-txt" class="text-6xl font-bold tracking-tighter">0.00</h2>
                <div class="flex justify-center items-center gap-2 mt-2">
                    <span class="text-cyan-400 font-bold text-sm">$MOOF</span>
                </div>
            </div>

            <div class="glass p-8 space-y-6">
                <div class="flex justify-between items-center">
                    <div>
                        <p class="text-[10px] opacity-40 font-bold uppercase">Mining Status</p>
                        <p id="status-label" class="text-lg font-bold">READY</p>
                    </div>
                    <i class="fa-solid fa-bolt-lightning text-cyan-400 animate-pulse text-xl"></i>
                </div>
                <button id="claim-btn" onclick="claimDaily()" class="w-full py-4 btn-claim rounded-xl uppercase text-xs tracking-widest">Start Mining</button>
                <div class="text-center">
                    <p class="text-[9px] opacity-30 uppercase mb-1">Next Harvest In</p>
                    <p id="countdown-txt" class="text-2xl font-light tracking-widest">00:00:00</p>
                </div>
            </div>
        </section>

        <section id="tab-tasks" class="tab-content hidden space-y-4">
            <h3 class="text-2xl font-bold mb-6">Missions</h3>
            
            <div class="glass p-5 flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-white/10 rounded-2xl flex items-center justify-center text-white"><i class="fa-brands fa-x-twitter text-2xl"></i></div>
                    <div><p class="font-bold">RT, Like & Comment</p><p class="text-xs text-cyan-400">+1,000 $MOOF</p></div>
                </div>
                <button id="m-xrt" onclick="doMission('https://x.com/i/status/2023423284822581737', 'xrt')" class="w-10 h-10 border border-white/10 rounded-full flex items-center justify-center"><i class="fa-solid fa-arrow-right text-xs"></i></button>
            </div>

            <div class="glass p-5 flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-blue-500/20 rounded-2xl flex items-center justify-center text-blue-400"><i class="fa-brands fa-telegram text-2xl"></i></div>
                    <div><p class="font-bold">Telegram</p><p class="text-xs text-cyan-400">+1,000 $MOOF</p></div>
                </div>
                <button id="m-tg" onclick="doMission('https://t.me/SI_MOOF_Official', 'tg')" class="w-10 h-10 border border-white/10 rounded-full flex items-center justify-center"><i class="fa-solid fa-arrow-right text-xs"></i></button>
            </div>
            <div class="glass p-5 flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-white/10 rounded-2xl flex items-center justify-center text-white"><i class="fa-brands fa-x-twitter text-2xl"></i></div>
                    <div><p class="font-bold">Follow X</p><p class="text-xs text-cyan-400">+1,000 $MOOF</p></div>
                </div>
                <button id="m-x" onclick="doMission('https://x.com/MoofGuyBase', 'x')" class="w-10 h-10 border border-white/10 rounded-full flex items-center justify-center"><i class="fa-solid fa-arrow-right text-xs"></i></button>
            </div>
            <div class="glass p-5 flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-red-500/20 rounded-2xl flex items-center justify-center text-red-500"><i class="fa-brands fa-youtube text-2xl"></i></div>
                    <div><p class="font-bold">Subscribe YT</p><p class="text-xs text-cyan-400">+1,000 $MOOF</p></div>
                </div>
                <button id="m-yt" onclick="doMission('https://www.youtube.com/@MOOFOFFICIAL', 'yt')" class="w-10 h-10 border border-white/10 rounded-full flex items-center justify-center"><i class="fa-solid fa-arrow-right text-xs"></i></button>
            </div>
        </section>

        <section id="tab-leaderboard" class="tab-content hidden space-y-6">
            <h3 class="text-2xl font-bold">Leaderboard</h3>
            <div class="glass overflow-hidden" id="leaderboard-list">
                <p class="p-10 text-center text-xs opacity-30">Loading players...</p>
            </div>
        </section>

        <section id="tab-account" class="tab-content hidden space-y-6">
            <div class="glass p-8 text-center">
                <div class="w-20 h-20 bg-white/5 rounded-full mx-auto flex items-center justify-center mb-4"><i class="fa-solid fa-user-astronaut text-3xl opacity-50"></i></div>
                <h4 id="user-display" class="font-bold text-xl uppercase">Anonymous</h4>
                <p id="addr-txt" class="text-[10px] opacity-30 font-mono mb-2">Disconnected</p>
                <div id="rank-display" class="inline-block px-3 py-1 bg-cyan-500/10 border border-cyan-500/20 rounded-full text-[10px] text-cyan-400 font-bold uppercase tracking-widest">Your Rank: Loading...</div>
            </div>
            <div class="glass p-6 space-y-4">
                <p class="text-[10px] font-bold uppercase opacity-40">Referral Link</p>
                <div class="bg-black/40 p-3 rounded-xl border border-white/5 break-all text-[10px]" id="ref-link-url">Connect wallet first.</div>
                <button onclick="copyRefLink()" class="w-full py-3 bg-white/5 rounded-xl text-[10px] font-bold uppercase">Copy Link</button>
            </div>
        </section>
    </main>

    <nav class="fixed bottom-0 left-0 right-0 h-24 flex justify-around items-center z-[100] glass rounded-t-[30px] border-t border-white/10 px-4">
        <button onclick="switchTab('home')" class="nav-btn nav-active flex flex-col items-center gap-2" id="btn-home"><i class="fa-solid fa-house-chimney text-xl"></i><span class="text-[9px] font-bold uppercase">Home</span></button>
        <button onclick="switchTab('leaderboard')" class="nav-btn opacity-50 flex flex-col items-center gap-2" id="btn-leaderboard"><i class="fa-solid fa-trophy text-xl"></i><span class="text-[9px] font-bold uppercase">Leaderboard</span></button>
        <button onclick="switchTab('tasks')" class="nav-btn opacity-50 flex flex-col items-center gap-2" id="btn-tasks"><i class="fa-solid fa-list-check text-xl"></i><span class="text-[9px] font-bold uppercase">Tasks</span></button>
        <button onclick="switchTab('account')" class="nav-btn opacity-50 flex flex-col items-center gap-2" id="btn-account"><i class="fa-solid fa-user-astronaut text-xl"></i><span class="text-[9px] font-bold uppercase">Account</span></button>
    </nav>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCB1opJ-J_A1ef6BucknOnWexeAiI3mj18",
            authDomain: "moof-airdrop-database.firebaseapp.com",
            databaseURL: "https://moof-airdrop-database-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "moof-airdrop-database",
            storageBucket: "moof-airdrop-database.firebasestorage.app",
            messagingSenderId: "462783818690",
            appId: "1:462783818690:web:67446d040e89d91d29045b"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const APP_KEY = "MOOF_ELITE_V2_FINAL";
        let state = JSON.parse(localStorage.getItem(APP_KEY)) || { bal: 0, claim: 0, addr: null, tasks: [] };

        const urlParams = new URLSearchParams(window.location.search);
        const refParent = urlParams.get('ref');

        function triggerHaptic() {
            if (window.navigator && window.navigator.vibrate) {
                window.navigator.vibrate(30); 
            }
        }

        function startApp() {
            updateUI();
            setInterval(handleTimer, 1000);
            let w = 0;
            const loadInt = setInterval(() => {
                w += 20; document.getElementById('load-progress').style.width = w + '%';
                if(w >= 100) { clearInterval(loadInt); document.getElementById('loader').style.opacity = '0'; setTimeout(() => document.getElementById('loader').style.display='none', 500); }
            }, 150);
        }

        async function connectWallet() {
            if (window.ethereum) {
                triggerHaptic();
                try {
                    const acc = await window.ethereum.request({ method: 'eth_requestAccounts' });
                    state.addr = acc[0].toLowerCase();
                    db.ref('users/' + state.addr).once('value', (s) => {
                        if(s.exists()) { 
                            state.bal = s.val().balance || 0; 
                            state.tasks = s.val().tasks || []; 
                        } else {
                            if(refParent && refParent.toLowerCase() !== state.addr) {
                                giveBonusToReferrer(refParent.toLowerCase());
                            }
                        }
                        updateUI(); syncToDB();
                    });
                } catch(e) { console.log("Rejected"); }
            } else { alert("Install Metamask!"); }
        }

        function giveBonusToReferrer(parent) {
            const bonus = 500; 
            db.ref('users/' + parent).once('value', (s) => {
                if(s.exists()) {
                    let oldBal = s.val().balance || 0;
                    db.ref('users/' + parent).update({ balance: oldBal + bonus });
                }
            });
        }

        function claimDaily() {
            if(!state.addr) return alert("Connect Wallet!");
            triggerHaptic();
            state.bal += 1000; state.claim = Date.now();
            updateUI(); syncToDB();
        }

        function syncToDB() {
            if(state.addr && db) {
                db.ref('users/' + state.addr).update({
                    address: state.addr, balance: state.bal, tasks: state.tasks, lastSeen: Date.now()
                });
            }
        }

        function updateUI() {
            if(state.addr) {
                db.ref('users/' + state.addr).on('value', (s) => {
                    if(s.exists()) {
                        state.bal = s.val().balance || 0;
                        state.tasks = s.val().tasks || [];
                        document.getElementById('balance-txt').innerText = state.bal.toLocaleString();
                        document.getElementById('wallet-btn').innerText = state.addr.substring(0,6)+"...";
                        document.getElementById('addr-txt').innerText = state.addr;
                        document.getElementById('user-display').innerText = "USER";
                        document.getElementById('ref-link-url').innerText = window.location.origin + window.location.pathname + "?ref=" + state.addr;
                        calculateMyRank();
                        localStorage.setItem(APP_KEY, JSON.stringify(state));
                    }
                });
            } else {
                document.getElementById('balance-txt').innerText = state.bal.toLocaleString();
            }
            state.tasks.forEach(id => {
                const btn = document.getElementById('m-' + id);
                if(btn) btn.innerHTML = '<i class="fa-solid fa-check text-cyan-400"></i>';
            });
        }

        function calculateMyRank() {
            db.ref('users').orderByChild('balance').once('value', (snap) => {
                let allPlayers = [];
                snap.forEach(s => { allPlayers.push({ addr: s.key, bal: s.val().balance }); });
                allPlayers.sort((a,b) => b.bal - a.bal);
                const myIdx = allPlayers.findIndex(p => p.addr === state.addr);
                document.getElementById('rank-display').innerText = "Your Rank: #" + (myIdx + 1);
            });
        }

        function switchTab(id) {
            triggerHaptic();
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(t => {
                t.classList.add('hidden');
                t.classList.remove('fade-active');
            });
            const activeTab = document.getElementById('tab-' + id);
            activeTab.classList.remove('hidden');
            setTimeout(() => { activeTab.classList.add('fade-active'); }, 50);

            document.querySelectorAll('.nav-btn').forEach(b => b.classList.add('opacity-50'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('nav-active'));
            document.getElementById('btn-' + id).classList.remove('opacity-50');
            document.getElementById('btn-' + id).classList.add('nav-active');
            if(id === 'leaderboard') renderRank();
        }

        function renderRank() {
            db.ref('users').orderByChild('balance').limitToLast(10).once('value', (snap) => {
                const list = document.getElementById('leaderboard-list');
                list.innerHTML = '';
                let players = [];
                snap.forEach(c => { players.push(c.val()); });
                players.reverse().forEach((p, i) => {
                    list.innerHTML += `<div class="p-4 flex justify-between border-b border-white/5"><span>#${i+1} ${p.address.substring(0,8)}...</span><span class="text-cyan-400 font-bold">${p.balance.toLocaleString()}</span></div>`;
                });
            });
        }

        function doMission(url, id) {
            if(!state.addr) return alert("Connect Wallet!");
            triggerHaptic();
            window.open(url, '_blank');
            setTimeout(() => { 
                if(!state.tasks.includes(id)) { 
                    state.tasks.push(id); 
                    state.bal += 1000; 
                    updateUI(); 
                    syncToDB(); 
                } 
            }, 5000);
        }

        function handleTimer() {
            const diff = Date.now() - (state.claim || 0);
            const btn = document.getElementById('claim-btn');
            if(diff < 86400000) {
                btn.disabled = true;
                btn.innerText = "MINING...";
                const rem = 86400000 - diff;
                const h = Math.floor(rem/3600000), m = Math.floor((rem%3600000)/60000), s = Math.floor((rem%60000)/1000);
                document.getElementById('countdown-txt').innerText = `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
            } else {
                btn.disabled = false;
                btn.innerText = "Start Mining";
                document.getElementById('countdown-txt').innerText = "00:00:00";
            }
        }

        function copyRefLink() {
            if(!state.addr) return alert("Connect Wallet!");
            triggerHaptic();
            const link = document.getElementById('ref-link-url').innerText;
            navigator.clipboard.writeText(link).then(() => alert("Copied!"));
        }

        window.onload = startApp;
    </script>
</body>
</html>
